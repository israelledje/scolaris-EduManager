<div id="main-teacher-display">
    <!-- Affichage du professeur titulaire actuel -->
    <div class="mb-4">
        <label class="text-sm font-medium text-slate-600">Professeur titulaire actuel</label>
        <div class="mt-2">
            {% if school_class.main_teacher %}
                <div class="flex items-center gap-3 p-3 bg-blue-50 border border-blue-200 rounded-lg">
                    <div class="w-10 h-10 bg-gradient-to-br from-blue-500 to-indigo-500 rounded-full flex items-center justify-center text-white font-semibold text-sm">
                        {{ school_class.main_teacher.first_name.0 }}{{ school_class.main_teacher.last_name.0 }}
                    </div>
                    <div class="flex-1">
                        <div class="font-semibold text-slate-900">
                            {{ school_class.main_teacher.last_name|upper }} {{ school_class.main_teacher.first_name }}
                        </div>
                        <div class="text-sm text-slate-600">
                            {% if school_class.main_teacher.main_subject %}
                                {{ school_class.main_teacher.main_subject.name }}
                            {% endif %}
                            {% if school_class.main_teacher.matricule %}
                                • {{ school_class.main_teacher.matricule }}
                            {% endif %}
                        </div>
                    </div>
                    <div class="text-xs text-blue-600 bg-blue-100 px-2 py-1 rounded-full">
                        Titulaire
                    </div>
                </div>
            {% else %}
                <div class="flex items-center gap-3 p-3 bg-slate-50 border border-slate-200 rounded-lg">
                    <div class="w-10 h-10 bg-slate-300 rounded-full flex items-center justify-center text-slate-500">
                        <i class="fas fa-user-tie"></i>
                    </div>
                    <div class="text-slate-500 italic">
                        Aucun professeur titulaire assigné
                    </div>
                </div>
            {% endif %}
        </div>
    </div>

    <!-- Boutons d'action -->
    <div class="flex items-center gap-3">
        <button type="button" 
                onclick="openMainTeacherModal()" 
                class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors duration-200 text-sm font-medium">
            <i class="fas fa-user-plus mr-2"></i>
            {% if school_class.main_teacher %}
                Modifier le professeur titulaire
            {% else %}
                Affecter un professeur titulaire
            {% endif %}
        </button>
        
        {% if school_class.main_teacher %}
        <button type="button" 
                onclick="removeMainTeacher()" 
                class="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors duration-200 text-sm font-medium">
            <i class="fas fa-trash mr-2"></i>Retirer le titulaire
        </button>
        {% endif %}
    </div>

    <!-- Informations -->
    <div class="mt-3 text-slate-500 text-xs leading-relaxed">
        <i class="fas fa-info-circle mr-1"></i>
        Le professeur titulaire est responsable de la classe et peut accéder à toutes les informations des élèves. 
        {% if school_class.main_teacher %}
            <strong>{{ school_class.main_teacher.first_name }} {{ school_class.main_teacher.last_name }}</strong> est actuellement titulaire de cette classe.
        {% else %}
            Aucun professeur n'est actuellement titulaire de cette classe.
        {% endif %}
    </div>
</div>

<script>
// Fonction pour retirer le professeur titulaire
function removeMainTeacher() {
    if (confirm('Êtes-vous sûr de vouloir retirer le professeur titulaire de cette classe ?')) {
        // Envoyer une requête AJAX pour retirer le professeur titulaire
        fetch("{% url 'classes:assign_main_teacher_htmx' school_class.id %}", {
            method: 'POST',
            headers: {
                'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value,
                'Content-Type': 'application/x-www-form-urlencoded',
            },
            body: 'teacher='
        })
        .then(response => response.text())
        .then(html => {
            // Mettre à jour l'affichage
            document.getElementById('main-teacher-display').outerHTML = html;
            showNotification('Professeur titulaire retiré avec succès', 'success');
        })
        .catch(error => {
            console.error('Erreur:', error);
            showNotification('Erreur lors de la suppression du professeur titulaire', 'error');
        });
    }
}

// Fonction utilitaire pour afficher des notifications
function showNotification(message, type = 'info') {
    // Créer une notification simple
    const notification = document.createElement('div');
    notification.className = `fixed top-4 right-4 p-4 rounded-lg shadow-lg z-50 ${
        type === 'success' ? 'bg-green-500 text-white' : 
        type === 'error' ? 'bg-red-500 text-white' : 
        'bg-blue-500 text-white'
    }`;
    notification.textContent = message;
    
    document.body.appendChild(notification);
    
    // Supprimer après 3 secondes
    setTimeout(() => {
        notification.remove();
    }, 3000);
}
</script>
